import{c as R,a as M,b as j,d as N,u as G,r as v,o as V,e as d,f as w,w as r,g as c,h as l,N as P,i as I,j as A,k as L,l as Z,m as B,n as T,F as $,p as E,q as z,s as D,t as ee,v as te,x as H,y as S,z as se,A as ae,B as le,C as q,D as ue,E as ne,G as oe}from"./vendor.ce46ea2d.js";const re=function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const f of e.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&t(f)}).observe(document,{childList:!0,subtree:!0});function a(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerpolicy&&(e.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?e.credentials="include":s.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function t(s){if(s.ep)return;s.ep=!0;const e=a(s);fetch(s.href,e)}};re();async function J(g){var t;const u=R(),a=await M.getBlockAttr(u,"custom-data");if(a&&a.value!="")try{const s=j.exports.AES.decrypt(a.value,g).toString(j.exports.enc.Utf8),e=JSON.parse(s);return e.type=="secret-block"?{success:!0,content:e.content,type:(t=e.content_type)!=null?t:"text"}:{success:!1}}catch(s){return{success:!1}}else return{success:!1,isFirst:!0}}const U=async(g,u,a)=>{const t=R(),s={type:"secret-block",content:g,content_type:a},e=j.exports.AES.encrypt(JSON.stringify(s),u).toString();await M.setBlockAttrs({id:t,attrs:{"custom-data":e}})},Q=()=>({head:["\u7528\u6237\u540D","\u5BC6\u7801"],body:[["",""],["",""],["",""]]}),ce=D("\u89E3\u9501"),ie=N({props:{unlock:null,lock:null},setup(g){const u=g,a=G(),t=v(""),s=[{label:"\u6587\u672C",value:"text"},{label:"\u8868\u683C",value:"sheet"}],e=v("text"),f=async()=>{const i=await J(t.value);i.success?u.unlock(t.value):i.isFirst?t.value===""?a.error("\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A\uFF01"):(await U("",t.value,e.value),u.unlock(t.value)):a.error("\u5BC6\u7801\u9519\u8BEF\uFF01")},b=i=>{t.value=i},m=i=>{i.key==="Enter"&&f()},h=v(!1);return V(async()=>{const i=R(),n=await M.getBlockAttr(i,"custom-data");n&&n.value!=""||(h.value=!0)}),(i,n)=>(d(),w(l(z),{"x-gap":"12",cols:"1 400:4",style:{margin:"auto",paddingLeft:"25px"}},{default:r(()=>[c(l(A),{span:"3"},{default:r(()=>[c(l(P),{"item-style":{margin:"10px",width:"100%"}},{default:r(()=>[c(l(I),{"on-update:value":b,placeholder:h.value?"\u8BF7\u8BBE\u7F6E\u521D\u59CB\u5BC6\u94A5":"\u8BF7\u8F93\u5165\u5BC6\u94A5",onKeyup:m,"passively-activated":"",round:"",type:"password"},null,8,["placeholder"])]),_:1})]),_:1}),c(l(A),{span:"1"},{default:r(()=>[c(l(P),{justify:"space-around","item-style":{margin:"10px"}},{default:r(()=>[c(l(L),{onClick:f,type:"primary",ghost:""},{default:r(()=>[ce]),_:1})]),_:1})]),_:1}),c(l(A),{span:"3"},{default:r(()=>[h.value?(d(),w(l(P),{key:0,justify:"center"},{default:r(()=>[c(l(Z),{value:e.value,"onUpdate:value":n[0]||(n[0]=x=>e.value=x),name:"radiobuttongroup1"},{default:r(()=>[(d(),B($,null,T(s,x=>c(l(ee),{key:x.value,value:x.value,label:x.label},{default:r(()=>[D(te(x.label),1)]),_:2},1032,["value","label"])),64))]),_:1},8,["value"])]),_:1})):E("",!0)]),_:1})]),_:1}))}}),de={style:{position:"relative",display:"flex",flex:"1"}},pe=D("\u5BC6"),ve=D("\xB7\xB7\xB7"),fe=N({props:{psd:null,lock:null,changePassword:null},setup(g){const u=g,a=v(""),t=v("text"),s=H.exports.debounce(()=>U(a.value,u.psd,t.value),200),e=H.exports.throttle(()=>window.sessionStorage.setItem("sy-secret-password-time",new Date().toUTCString()),1e3),f=v(null),b=v(!1),m=()=>{const o=f.value.$refs.textareaElRef;o.scrollHeight>o.clientHeight?b.value=!0:b.value=!1},h=o=>{a.value=o,e(),s(),m()},i=()=>{a.value=JSON.stringify(n.value),e(),s()},n=v(Q()),x=async()=>{const o=await J(u.psd);if(o.success){if(a.value=o.content,t.value=o.type,t.value==="sheet")try{n.value=JSON.parse(a.value)}catch(y){n.value=Q()}}else u.lock();m()};V(()=>x());const p=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_","-","$","%","&","@","+","!"],_=()=>{const o=14;let y="",k=p.length;for(let F=0;F<o;F++){let O=Math.floor(Math.random()*k);y+=p[O]}h(y)},C=async o=>{if(o==="lock-now")await U(a.value,u.psd,t.value),u.lock();else if(o==="change-password")u.changePassword(a.value,t.value);else if(o==="add-row"){const y=n.value.head.length;n.value.body.push(new Array(y).fill(""))}else o==="add-col"?(n.value.head.push(""),n.value.body.forEach(y=>y.push(""))):o==="del-row"?n.value.body.splice(n.value.body.length-1,1):o==="del-col"&&(n.value.head.splice(n.value.head.length-1,1),n.value.body.forEach(y=>y.splice(y.length-1,1)))},K=()=>{let o=[{label:"\u7ACB\u5373\u9501\u5B9A",key:"lock-now"},{label:"\u4FEE\u6539\u5BC6\u7801",key:"change-password"}];return t.value==="sheet"&&(o=[...o,{label:"\u589E\u52A0\u4E00\u884C",key:"add-row"},{label:"\u589E\u52A0\u4E00\u5217",key:"add-col"},{label:"\u5220\u9664\u4E00\u884C",key:"del-row"},{label:"\u5220\u9664\u4E00\u5217",key:"del-col"}]),o},W=o=>y=>{n.value.head[o]=y,i()},X=(o,y)=>k=>{n.value.body[o][y]=k,i()};return(o,y)=>(d(),B("div",de,[t.value==="text"?(d(),w(l(I),{key:0,ref:(k,F)=>{F.inputRef=k,f.value=k},type:"textarea","on-update:value":h,value:a.value,placeholder:"\u79D8\u5BC6\u85CF\u5728\u8FD9~",style:{display:"flex",flex:"1","--padding-right":"0px"}},null,8,["value"])):E("",!0),t.value==="sheet"?(d(),w(l(se),{key:1,bordered:!1,"single-line":!1},{default:r(()=>[S("thead",null,[S("tr",null,[(d(!0),B($,null,T(n.value.head,(k,F)=>(d(),B("th",null,[c(l(I),{value:k,"on-update:value":W(F)},null,8,["value","on-update:value"])]))),256))])]),S("tbody",null,[(d(!0),B($,null,T(n.value.body,(k,F)=>(d(),B("tr",null,[(d(!0),B($,null,T(k,(O,Y)=>(d(),B("td",null,[c(l(I),{value:O,"on-update:value":X(F,Y),placeholder:"... ..."},null,8,["value","on-update:value"])]))),256))]))),256))])]),_:1})):E("",!0),a.value===""?(d(),w(l(L),{key:2,circle:"",style:{position:"absolute",right:"5px",bottom:"5px"},onClick:_},{default:r(()=>[pe]),_:1})):E("",!0),c(l(le),{trigger:"click",onSelect:C,options:K(),placement:"bottom-end"},{default:r(()=>[c(l(L),{circle:"",style:ae({position:"absolute",right:b.value?"20px":"5px",top:"5px",backgroundColor:"white"}),size:"small"},{default:r(()=>[ve]),_:1},8,["style"])]),_:1},8,["options"])]))}}),ye={style:{marginLeft:"10px",marginRight:"10px"}},he=S("div",{style:{marginTop:"10px",marginLeft:"20px",marginRight:"20px"}},"\u6CE8\u610F\uFF1A\u4FEE\u6539\u5BC6\u7801\u53EA\u4F1A\u4FEE\u6539\u5F53\u524D\u5757\u7684\u5BC6\u7801\uFF0C\u4E0D\u4F1A\u5F71\u54CD\u5176\u4ED6\u5757\uFF01",-1),ge=D("\u4FEE\u6539"),_e=D("\u53D6\u6D88"),me=N({props:{unlock:null,psd:null,content:null,type:null},setup(g){const u=g,a=G(),t=v(""),s=v(!1),e=v(null),f=async()=>{if(t.value===""){a.error("\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}s.value=!0,await U(u.content,t.value,u.type),e.value=setInterval(()=>{u.unlock(t.value,!1)},500)};q(()=>{e.value!=null&&clearInterval(e.value)});const b=()=>{u.unlock(u.psd)},m=i=>{t.value=i},h=i=>{i.key==="Enter"&&f()};return(i,n)=>(d(),w(l(z),{"x-gap":"12",cols:"2",style:{margin:"auto"}},{default:r(()=>[c(l(A),{span:"2"},{default:r(()=>[S("div",ye,[c(l(I),{value:t.value,"on-update:value":m,placeholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801",onKeyup:h},null,8,["value"])])]),_:1}),c(l(A),{span:"2"},{default:r(()=>[he]),_:1}),c(l(A),{span:"2"},{default:r(()=>[c(l(P),{justify:"space-around",style:{marginTop:"10px"}},{default:r(()=>[c(l(L),{disabled:s.value,onClick:f,ghost:"",type:"primary"},{default:r(()=>[ge]),_:1},8,["disabled"]),c(l(L),{disabled:s.value,onClick:b,ghost:"",type:"error"},{default:r(()=>[_e]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}});const we={style:{display:"flex",flex:"1",padding:"5px"}},xe=N({setup(g){const u=G(),a=v(""),t=async(p,_)=>{const C=await J(p);C.success?(m.value="secret-content",a.value=p,f.value=""):C.isFirst||(_!=!1&&u.error("\u5BC6\u7801\u9519\u8BEF"),f.value=p)},s=async(p,_)=>{await t(p,_),window.sessionStorage.setItem("sy-secret-password",p),window.sessionStorage.setItem("sy-secret-password-time",new Date().toUTCString())},e=()=>{m.value="password-input",a.value="",window.sessionStorage.removeItem("sy-secret-password"),window.sessionStorage.removeItem("sy-secret-password-time")},f=v(""),b=setInterval(()=>{const p=window.sessionStorage.getItem("sy-secret-password"),_=window.sessionStorage.getItem("sy-secret-password-time");if(_!=null&&_!=""&&p!=""&&p!=null){const C=new Date(_);new Date().getTime()-C.getTime()>1e3*60*10?e():h("password-input")&&t(p)}else e()},500);q(()=>{clearInterval(b)});const m=v("password-input"),h=p=>m.value===p,i=v(""),n=v("text"),x=(p,_)=>{m.value="change-password",i.value=p,n.value=_};return(p,_)=>(d(),w(l(ue),{embedded:"","content-style":{height:"100vh",display:"flex"}},{default:r(()=>[S("div",we,[h("password-input")?(d(),w(ie,{key:0,unlock:s,lock:e})):E("",!0),h("secret-content")?(d(),w(fe,{key:1,psd:a.value,lock:e,"change-password":x},null,8,["psd"])):E("",!0),h("change-password")?(d(),w(me,{key:2,unlock:s,psd:a.value,content:i.value,type:n.value},null,8,["psd","content","type"])):E("",!0)])]),_:1}))}}),ke=N({setup(g){return(u,a)=>(d(),w(l(ne),null,{default:r(()=>[c(xe)]),_:1}))}});oe(ke).mount("#app");
//# sourceMappingURL=index.8c21d457.js.map
